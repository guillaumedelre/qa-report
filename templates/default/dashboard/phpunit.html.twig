{% extends 'base.html.twig' %}

{% block title %}QA-Tools | {{ page_section|capitalize|e }} {{ page_name|capitalize|e }}{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="../assets/css/sunburst.css">
    <link rel="stylesheet" href="../assets/css/gauge.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/default.min.css" />
{% endblock %}

{% block navigation %}
    {{ include('default/dashboard/navigation.html.twig') }}
{% endblock %}

{% block content %}
    <main role="main" class="container-fluid">
        <div class="card-columns my-3">
            {% include 'default/dashboard/organisms/file_list.html.twig' %}
            {% include 'default/dashboard/organisms/clover_gauge_graph.html.twig' %}
            {% include 'default/dashboard/organisms/clover_sunburst_graph.html.twig' %}
            {% include 'default/dashboard/organisms/junit_tests_sum.html.twig' %}
            {% include 'default/dashboard/organisms/junit_times_sum.html.twig' %}
            {% include 'default/dashboard/organisms/crap_gauge_graph.html.twig' %}
            {% include 'default/dashboard/organisms/crap_methods_graph.html.twig' %}
        </div>

    </main>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.1/d3.min.js"></script>
    <script src="../assets/js/sunburst.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/highcharts-more.js"></script>
    <script src="https://code.highcharts.com/modules/solid-gauge.js"></script>
    <script src="../assets/js/gauge.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
    <script type="text/javascript">
        hljs.initHighlightingOnLoad();
        Highcharts.chart('gauge-clover', Highcharts.merge(gaugeCloverOptions, {
            yAxis: {
                min: 0,
                max: 100,
            },

            credits: {
                enabled: false
            },

            series: [{
                name: 'coverage',
                data: [{{ cloverAvgCoverage(artifacts) }}],
                dataLabels: {
                    format: '<div style="text-align:center"><span style="font-size:25px;color:' +
                        ((Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black') + '">{y}</span><br/>' +
                        '<span style="font-size:12px;color:silver">%</span></div>'
                },
                tooltip: {
                    valueSuffix: ' %'
                }
            }]

        }));
        Highcharts.chart('gauge-crap', Highcharts.merge(gaugeCrapOptions, {
            yAxis: {
                min: 0,
                max: 100,
            },

            credits: {
                enabled: false
            },

            series: [{
                name: 'crap',
                data: [{{ crapAvgPercent(artifacts) }}],
                dataLabels: {
                    format: '<div style="text-align:center"><span style="font-size:25px;color:' +
                        ((Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black') + '">{y}</span><br/>' +
                        '<span style="font-size:12px;color:silver">%</span></div>'
                },
                tooltip: {
                    valueSuffix: ' %'
                }
            }]

        }));
        {{ sunburst(artifacts)|raw }}
        {{ graphCrap('canvas-crap', artifacts)|raw }}
    </script>
{% endblock %}
